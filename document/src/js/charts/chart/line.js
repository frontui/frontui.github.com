/*! 
*  frontui v1.0.2
*  by frontpay FE Team
*  (c) 2016-03-25 www.frontpay.cn
*  Licensed under Apache License
*/
define("echarts/chart/line",["require","./base","zrender/shape/Polyline","../util/shape/Icon","../util/shape/HalfSmoothPolygon","../component/axis","../component/grid","../component/dataZoom","../config","../util/ecData","zrender/tool/util","zrender/tool/color","../chart"],function(t){function e(t,e,i,o,s){a.call(this,t,e,i,o,s),this.refresh(o)}function i(t,e,i){var a=e.x,o=e.y,n=e.width,r=e.height,l=r/2;e.symbol.match("empty")&&(t.fillStyle="#fff"),e.brushType="both";var h=e.symbol.replace("empty","").toLowerCase();h.match("star")?(l=h.replace("star","")-0||5,o-=1,h="star"):("rectangle"===h||"arrow"===h)&&(a+=(n-r)/2,n=r);var m="";if(h.match("image")&&(m=h.replace(new RegExp("^image:\\/\\/"),""),h="image",a+=Math.round((n-r)/2)-1,n=r+=2),h=s.prototype.iconLibrary[h]){var p=e.x,u=e.y;t.moveTo(p,u+l),t.lineTo(p+5,u+l),t.moveTo(p+e.width-5,u+l),t.lineTo(p+e.width,u+l);var d=this;h(t,{x:a+4,y:o+4,width:n-8,height:r-8,n:l,image:m},function(){d.modSelf(),i()})}else t.moveTo(a,o+l),t.lineTo(a+n,o+l)}var a=t("./base"),o=t("zrender/shape/Polyline"),s=t("../util/shape/Icon"),n=t("../util/shape/HalfSmoothPolygon");t("../component/axis"),t("../component/grid"),t("../component/dataZoom");var r=t("../config");r.line={zlevel:0,z:2,clickable:!0,legendHoverLink:!0,xAxisIndex:0,yAxisIndex:0,dataFilter:"nearest",itemStyle:{normal:{label:{show:!1},lineStyle:{width:2,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}},emphasis:{label:{show:!1}}},symbolSize:2,showAllSymbol:!1};var l=t("../util/ecData"),h=t("zrender/tool/util"),m=t("zrender/tool/color");return e.prototype={type:r.CHART_TYPE_LINE,_buildShape:function(){this.finalPLMap={},this._buildPosition()},_buildHorizontal:function(t,e,i,a){for(var o,s,n,r,l,h,m,p,u,d=this.series,g=i[0][0],y=d[g],f=this.component.xAxis.getAxis(y.xAxisIndex||0),c={},x=0,v=e;v>x&&null!=f.getNameByIndex(x);x++){s=f.getCoordByIndex(x);for(var L=0,I=i.length;I>L;L++){o=this.component.yAxis.getAxis(d[i[L][0]].yAxisIndex||0),l=r=m=h=o.getCoord(0);for(var b=0,S=i[L].length;S>b;b++)g=i[L][b],y=d[g],p=y.data[x],u=this.getDataFromOption(p,"-"),c[g]=c[g]||[],a[g]=a[g]||{min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY,sum:0,counter:0,average:0},"-"!==u?(u>=0?(r-=b>0?o.getCoordSize(u):l-o.getCoord(u),n=r):0>u&&(h+=b>0?o.getCoordSize(u):o.getCoord(u)-m,n=h),c[g].push([s,n,x,f.getNameByIndex(x),s,l]),a[g].min>u&&(a[g].min=u,a[g].minY=n,a[g].minX=s),a[g].max<u&&(a[g].max=u,a[g].maxY=n,a[g].maxX=s),a[g].sum+=u,a[g].counter++):c[g].length>0&&(this.finalPLMap[g]=this.finalPLMap[g]||[],this.finalPLMap[g].push(c[g]),c[g]=[])}r=this.component.grid.getY();for(var M,L=0,I=i.length;I>L;L++)for(var b=0,S=i[L].length;S>b;b++)g=i[L][b],y=d[g],p=y.data[x],u=this.getDataFromOption(p,"-"),"-"==u&&this.deepQuery([p,y,this.option],"calculable")&&(M=this.deepQuery([p,y],"symbolSize"),r+=2*M+5,n=r,this.shapeList.push(this._getCalculableItem(g,x,f.getNameByIndex(x),s,n,"horizontal")))}for(var _ in c)c[_].length>0&&(this.finalPLMap[_]=this.finalPLMap[_]||[],this.finalPLMap[_].push(c[_]),c[_]=[]);this._calculMarkMapXY(a,i,"y"),this._buildBorkenLine(t,this.finalPLMap,f,"horizontal")},_buildVertical:function(t,e,i,a){for(var o,s,n,r,l,h,m,p,u,d=this.series,g=i[0][0],y=d[g],f=this.component.yAxis.getAxis(y.yAxisIndex||0),c={},x=0,v=e;v>x&&null!=f.getNameByIndex(x);x++){n=f.getCoordByIndex(x);for(var L=0,I=i.length;I>L;L++){o=this.component.xAxis.getAxis(d[i[L][0]].xAxisIndex||0),l=r=m=h=o.getCoord(0);for(var b=0,S=i[L].length;S>b;b++)g=i[L][b],y=d[g],p=y.data[x],u=this.getDataFromOption(p,"-"),c[g]=c[g]||[],a[g]=a[g]||{min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY,sum:0,counter:0,average:0},"-"!==u?(u>=0?(r+=b>0?o.getCoordSize(u):o.getCoord(u)-l,s=r):0>u&&(h-=b>0?o.getCoordSize(u):m-o.getCoord(u),s=h),c[g].push([s,n,x,f.getNameByIndex(x),l,n]),a[g].min>u&&(a[g].min=u,a[g].minX=s,a[g].minY=n),a[g].max<u&&(a[g].max=u,a[g].maxX=s,a[g].maxY=n),a[g].sum+=u,a[g].counter++):c[g].length>0&&(this.finalPLMap[g]=this.finalPLMap[g]||[],this.finalPLMap[g].push(c[g]),c[g]=[])}r=this.component.grid.getXend();for(var M,L=0,I=i.length;I>L;L++)for(var b=0,S=i[L].length;S>b;b++)g=i[L][b],y=d[g],p=y.data[x],u=this.getDataFromOption(p,"-"),"-"==u&&this.deepQuery([p,y,this.option],"calculable")&&(M=this.deepQuery([p,y],"symbolSize"),r-=2*M+5,s=r,this.shapeList.push(this._getCalculableItem(g,x,f.getNameByIndex(x),s,n,"vertical")))}for(var _ in c)c[_].length>0&&(this.finalPLMap[_]=this.finalPLMap[_]||[],this.finalPLMap[_].push(c[_]),c[_]=[]);this._calculMarkMapXY(a,i,"x"),this._buildBorkenLine(t,this.finalPLMap,f,"vertical")},_buildOther:function(t,e,i,a){for(var o,s=this.series,n={},r=0,l=i.length;l>r;r++)for(var h=0,m=i[r].length;m>h;h++){var p=i[r][h],u=s[p];o=this.component.xAxis.getAxis(u.xAxisIndex||0);var d=this.component.yAxis.getAxis(u.yAxisIndex||0),g=d.getCoord(0);n[p]=n[p]||[],a[p]=a[p]||{min0:Number.POSITIVE_INFINITY,min1:Number.POSITIVE_INFINITY,max0:Number.NEGATIVE_INFINITY,max1:Number.NEGATIVE_INFINITY,sum0:0,sum1:0,counter0:0,counter1:0,average0:0,average1:0};for(var y=0,f=u.data.length;f>y;y++){var c=u.data[y],x=this.getDataFromOption(c,"-");if(x instanceof Array){var v=o.getCoord(x[0]),L=d.getCoord(x[1]);n[p].push([v,L,y,x[0],v,g]),a[p].min0>x[0]&&(a[p].min0=x[0],a[p].minY0=L,a[p].minX0=v),a[p].max0<x[0]&&(a[p].max0=x[0],a[p].maxY0=L,a[p].maxX0=v),a[p].sum0+=x[0],a[p].counter0++,a[p].min1>x[1]&&(a[p].min1=x[1],a[p].minY1=L,a[p].minX1=v),a[p].max1<x[1]&&(a[p].max1=x[1],a[p].maxY1=L,a[p].maxX1=v),a[p].sum1+=x[1],a[p].counter1++}}}for(var I in n)n[I].length>0&&(this.finalPLMap[I]=this.finalPLMap[I]||[],this.finalPLMap[I].push(n[I]),n[I]=[]);this._calculMarkMapXY(a,i,"xy"),this._buildBorkenLine(t,this.finalPLMap,o,"other")},_buildBorkenLine:function(t,e,i,a){for(var s,r="other"==a?"horizontal":a,p=this.series,u=t.length-1;u>=0;u--){var d=t[u],g=p[d],y=e[d];if(g.type===this.type&&null!=y)for(var f=this._getBbox(d,r),c=this._sIndex2ColorMap[d],x=this.query(g,"itemStyle.normal.lineStyle.width"),v=this.query(g,"itemStyle.normal.lineStyle.type"),L=this.query(g,"itemStyle.normal.lineStyle.color"),I=this.getItemStyleColor(this.query(g,"itemStyle.normal.color"),d,-1),b=null!=this.query(g,"itemStyle.normal.areaStyle"),S=this.query(g,"itemStyle.normal.areaStyle.color"),M=0,_=y.length;_>M;M++){var z=y[M],A="other"!=a&&this._isLarge(r,z);if(A)z=this._getLargePointList(r,z,g.dataFilter);else for(var C=0,P=z.length;P>C;C++)s=g.data[z[C][2]],(this.deepQuery([s,g,this.option],"calculable")||this.deepQuery([s,g],"showAllSymbol")||"categoryAxis"===i.type&&i.isMainAxis(z[C][2])&&"none"!=this.deepQuery([s,g],"symbol"))&&this.shapeList.push(this._getSymbol(d,z[C][2],z[C][3],z[C][0],z[C][1],r));var Y=new o({zlevel:this.getZlevelBase(),z:this.getZBase(),style:{miterLimit:x,pointList:z,strokeColor:L||I||c,lineWidth:x,lineType:v,smooth:this._getSmooth(g.smooth),smoothConstraint:f,shadowColor:this.query(g,"itemStyle.normal.lineStyle.shadowColor"),shadowBlur:this.query(g,"itemStyle.normal.lineStyle.shadowBlur"),shadowOffsetX:this.query(g,"itemStyle.normal.lineStyle.shadowOffsetX"),shadowOffsetY:this.query(g,"itemStyle.normal.lineStyle.shadowOffsetY")},hoverable:!1,_main:!0,_seriesIndex:d,_orient:r});if(l.pack(Y,p[d],d,0,M,p[d].name),this.shapeList.push(Y),b){var N=new n({zlevel:this.getZlevelBase(),z:this.getZBase(),style:{miterLimit:x,pointList:h.clone(z).concat([[z[z.length-1][4],z[z.length-1][5]],[z[0][4],z[0][5]]]),brushType:"fill",smooth:this._getSmooth(g.smooth),smoothConstraint:f,color:S?S:m.alpha(c,.5)},highlightStyle:{brushType:"fill"},hoverable:!1,_main:!0,_seriesIndex:d,_orient:r});l.pack(N,p[d],d,0,M,p[d].name),this.shapeList.push(N)}}}},_getBbox:function(t,e){var i=this.component.grid.getBbox(),a=this.xMarkMap[t];return null!=a.minX0?[[Math.min(a.minX0,a.maxX0,a.minX1,a.maxX1),Math.min(a.minY0,a.maxY0,a.minY1,a.maxY1)],[Math.max(a.minX0,a.maxX0,a.minX1,a.maxX1),Math.max(a.minY0,a.maxY0,a.minY1,a.maxY1)]]:("horizontal"===e?(i[0][1]=Math.min(a.minY,a.maxY),i[1][1]=Math.max(a.minY,a.maxY)):(i[0][0]=Math.min(a.minX,a.maxX),i[1][0]=Math.max(a.minX,a.maxX)),i)},_isLarge:function(t,e){return e.length<2?!1:"horizontal"===t?Math.abs(e[0][0]-e[1][0])<.5:Math.abs(e[0][1]-e[1][1])<.5},_getLargePointList:function(t,e,i){var a;a="horizontal"===t?this.component.grid.getWidth():this.component.grid.getHeight();var o=e.length,s=[];if("function"!=typeof i)switch(i){case"min":i=function(t){return Math.max.apply(null,t)};break;case"max":i=function(t){return Math.min.apply(null,t)};break;case"average":i=function(t){for(var e=0,i=0;i<t.length;i++)e+=t[i];return e/t.length};break;default:i=function(t){return t[0]}}for(var n=[],r=0;a>r;r++){var l=Math.floor(o/a*r),h=Math.min(Math.floor(o/a*(r+1)),o);if(!(l>=h)){for(var m=l;h>m;m++)n[m-l]="horizontal"===t?e[m][1]:e[m][0];n.length=h-l;for(var p=i(n),u=-1,d=1/0,m=l;h>m;m++){var g="horizontal"===t?e[m][1]:e[m][0],y=Math.abs(g-p);d>y&&(u=m,d=y)}var f=e[u].slice();"horizontal"===t?f[1]=p:f[0]=p,s.push(f)}}return s},_getSmooth:function(t){return t?.3:0},_getCalculableItem:function(t,e,i,a,o,s){var n=this.series,l=n[t].calculableHolderColor||this.ecTheme.calculableHolderColor||r.calculableHolderColor,h=this._getSymbol(t,e,i,a,o,s);return h.style.color=l,h.style.strokeColor=l,h.rotation=[0,0],h.hoverable=!1,h.draggable=!1,h.style.text=void 0,h},_getSymbol:function(t,e,i,a,o,s){var n=this.series,r=n[t],l=r.data[e],h=this.getSymbolShape(r,t,l,e,i,a,o,this._sIndex2ShapeMap[t],this._sIndex2ColorMap[t],"#fff","vertical"===s?"horizontal":"vertical");return h.zlevel=this.getZlevelBase(),h.z=this.getZBase()+1,this.deepQuery([l,r,this.option],"calculable")&&(this.setCalculable(h),h.draggable=!0),h},getMarkCoord:function(t,e){var i=this.series[t],a=this.xMarkMap[t],o=this.component.xAxis.getAxis(i.xAxisIndex),s=this.component.yAxis.getAxis(i.yAxisIndex);if(e.type&&("max"===e.type||"min"===e.type||"average"===e.type)){var n=null!=e.valueIndex?e.valueIndex:null!=a.maxX0?"1":"";return[a[e.type+"X"+n],a[e.type+"Y"+n],a[e.type+"Line"+n],a[e.type+n]]}return["string"!=typeof e.xAxis&&o.getCoordByIndex?o.getCoordByIndex(e.xAxis||0):o.getCoord(e.xAxis||0),"string"!=typeof e.yAxis&&s.getCoordByIndex?s.getCoordByIndex(e.yAxis||0):s.getCoord(e.yAxis||0)]},refresh:function(t){t&&(this.option=t,this.series=t.series),this.backupShapeList(),this._buildShape()},ontooltipHover:function(t,e){for(var i,a,o=t.seriesIndex,s=t.dataIndex,n=o.length;n--;)if(i=this.finalPLMap[o[n]])for(var r=0,l=i.length;l>r;r++){a=i[r];for(var h=0,m=a.length;m>h;h++)s===a[h][2]&&e.push(this._getSymbol(o[n],a[h][2],a[h][3],a[h][0],a[h][1],"horizontal"))}},addDataAnimation:function(t,e){function i(){y--,0===y&&e&&e()}function a(t){t.style.controlPointList=null}for(var o=this.series,s={},n=0,r=t.length;r>n;n++)s[t[n][0]]=t[n];for(var l,h,m,p,u,d,g,y=0,n=this.shapeList.length-1;n>=0;n--)if(u=this.shapeList[n]._seriesIndex,s[u]&&!s[u][3]){if(this.shapeList[n]._main&&this.shapeList[n].style.pointList.length>1){if(d=this.shapeList[n].style.pointList,h=Math.abs(d[0][0]-d[1][0]),p=Math.abs(d[0][1]-d[1][1]),g="horizontal"===this.shapeList[n]._orient,s[u][2]){if("half-smooth-polygon"===this.shapeList[n].type){var f=d.length;this.shapeList[n].style.pointList[f-3]=d[f-2],this.shapeList[n].style.pointList[f-3][g?0:1]=d[f-4][g?0:1],this.shapeList[n].style.pointList[f-2]=d[f-1]}this.shapeList[n].style.pointList.pop(),g?(l=h,m=0):(l=0,m=-p)}else{if(this.shapeList[n].style.pointList.shift(),"half-smooth-polygon"===this.shapeList[n].type){var c=this.shapeList[n].style.pointList.pop();g?c[0]=d[0][0]:c[1]=d[0][1],this.shapeList[n].style.pointList.push(c)}g?(l=-h,m=0):(l=0,m=p)}this.shapeList[n].style.controlPointList=null,this.zr.modShape(this.shapeList[n])}else{if(s[u][2]&&this.shapeList[n]._dataIndex===o[u].data.length-1){this.zr.delShape(this.shapeList[n].id);continue}if(!s[u][2]&&0===this.shapeList[n]._dataIndex){this.zr.delShape(this.shapeList[n].id);continue}}this.shapeList[n].position=[0,0],y++,this.zr.animate(this.shapeList[n].id,"").when(this.query(this.option,"animationDurationUpdate"),{position:[l,m]}).during(a).done(i).start()}y||i()}},s.prototype.iconLibrary.legendLineIcon=i,h.inherits(e,a),t("../chart").define("line",e),e}),define("echarts/util/shape/HalfSmoothPolygon",["require","zrender/shape/Base","zrender/shape/util/smoothBezier","zrender/tool/util","zrender/shape/Polygon"],function(t){function e(t){i.call(this,t)}var i=t("zrender/shape/Base"),a=t("zrender/shape/util/smoothBezier"),o=t("zrender/tool/util");return e.prototype={type:"half-smooth-polygon",buildPath:function(e,i){var o=i.pointList;if(!(o.length<2))if(i.smooth){var s=a(o.slice(0,-2),i.smooth,!1,i.smoothConstraint);e.moveTo(o[0][0],o[0][1]);for(var n,r,l,h=o.length,m=0;h-3>m;m++)n=s[2*m],r=s[2*m+1],l=o[m+1],e.bezierCurveTo(n[0],n[1],r[0],r[1],l[0],l[1]);e.lineTo(o[h-2][0],o[h-2][1]),e.lineTo(o[h-1][0],o[h-1][1]),e.lineTo(o[0][0],o[0][1])}else t("zrender/shape/Polygon").prototype.buildPath(e,i)}},o.inherits(e,i),e});
/*! 
*  frontui v1.0.2
*  by frontpay FE Team
*  (c) 5/17/2016 www.frontpay.cn
*  Licensed under Apache License
*/
"use strict";function dropMenus(t,e){var r=getParent(t);active=t.data("active")||active;var o=r.hasClass(active);void 0===e&&clearMenus(),o||(r.addClass(active),t.attr("aria-expanded",!0).trigger("show.ui.dropdown",this))}function clearMenus(t,e){$(toggle).each(function(){var r=$(this),o=getParent(r),i=o.find(toggle),n=r.attr("data-auto");active=r.data("active")||active,o.hasClass(active)&&(t&&t.isDefaultPrevented()||(e&&n&&autoFill(r,i),o.removeClass(active).find(list).removeClass("hover").show(),r.attr("aria-expanded","false").trigger("hide.ui.dropdown",this).data("currentItem",-1),i.length&&i.trigger("blur")))})}function hideAllMenus(t){clearMenus(t,1)}function autoFill(t,e){var r,o=getList(t),i=0,n="",a=$.trim(e.val());r=o.filter(function(){return $(this).is(":visible")?(0===i&&(n=$.trim($(this).text()),i=n==a?1:0),!0):!1}),i||(0===r.length?o.eq(0).trigger("click"):r.eq(0).trigger("click.ui.dropSelect"))}function chkMatch(){var t=$(this),e=t.attr("placeholder"),r=$.trim(t.val()),o=getList(t);""!==r&&r!==e&&o.hide().filter(function(){var t=$.trim($(this).text())||"";return t==r&&$(this).addClass("hover"),t.indexOf(r)>-1}).show()}function getParent(t){var e=$(t).data("target")||$(t).parent();return e}function getList(t){var e=getParent(t);return e.find(list)}function scrollTop(t,e){var r=t.parent(),o=t.eq(e).position().top;r.scrollTop(o)}function Plugin(t){var e=[].slice.call(arguments,1);return $(this).each(function(){var r=$(this),o=r.data("ui.dropdown");o||r.data("ui.dropdown",o=new Dropdown(this)),"string"==typeof t&&o[t].apply(this,e)})}var active="active",wrap=".form-control-dropdown",toggle='[data-toggle="dropdown"],.form-control-dropdown-value',toggleBtn='.form-control-dropdown-btn, [data-toggle="dropdown-btn"]',toggleIBtn='.form-control-dropdown-btn > i, [data-toggle="dropdown-btn"] > i',ul=".form-control-dropdown-menu",list='.form-control-dropdown-menu li, [role="list"] li',Dropdown=function(t){$(t).on("click.ui.dropdown",this.toggle),/input/i.test(t.tagName)&&$(t).on("keyup.ui.dropFilter",this.filter);var e=getParent(t);e.on("click.ui.dropSelect",list,this.selected(e))};Dropdown.VERSION="1.0.0",Dropdown.prototype.toggle=function(t){var e=$(this);if(!e.is(".disabled,:disabled"))return dropMenus(e),!1},Dropdown.prototype.keydown=function(t){if(27===t.which)return void clearMenus(t);if(/(38|40|27|32|13|46|8)/.test(t.which)){var e=$(this),r=void 0===e.data("currentItem")?-1:e.data("currentItem");if(t.stopPropagation(),!e.is(".disabled, :disabled")){var o=getParent(e);active=e.data("active")||active;var i=o.hasClass(active);if(!i&&27!=t.which||i&&27==t.which)return 27==t.which&&o.find(toggle).trigger("focus"),e.trigger("click");var n=o.find(list).filter(":visible");if(n.length){if(13==t.which&&n.filter(".hover").length)return void n.filter(".hover").trigger("click.ui.dropSelect");var a=n.index(t.target)>-1?n.index(t.target):r;38==t.which&&a>=0&&a--,40==t.which&&a<n.length&&a++,0>a&&(a=n.length-1),a>=n.length&&(a=0),scrollTop(n,a),e.data("currentItem",a),n.removeClass("hover").eq(a).addClass("hover").trigger("focus")}}}},Dropdown.prototype.selected=function(t){var e=t.find(toggle);return function(t){t.preventDefault(),t.stopPropagation();var r=/input/i.test(e[0].tagName),o=$.trim($(this)[r?"text":"html"]());return e[r?"val":"html"](o).trigger("selected.ui.dropdown",this).trigger("blur"),clearMenus(),!1}},Dropdown.prototype.filter=function(t){if(/input/i.test(t.target.tagName)){var e=$(this),r=$.trim(e.val()),o=getList(e);return""===r?void o.show():void(o.length&&o.map(function(){var t=$(this).text();return t.indexOf(r)>-1?$(this).show():$(this).hide()}))}},Dropdown.prototype.focusIn=function(t){var e=$(this);dropMenus(e,!0)},$.fn.dropdown=Plugin,$.fn.dropdown.Constructor=Dropdown,$(function(){$(toggle).dropdown(),$(document).on("click.ui.dropdown",hideAllMenus).on("click.ui.dropdown-btn",function(t){var e=t.target;if($(e).is(toggleBtn)||$(e).is(toggleIBtn)){var r=$(e).closest(wrap),o=r.find(toggle);return dropMenus(o),!1}}).on("click.ui.dropdown",function(t){var e=t.target;return $(e).is(ul)?(t.stopPropagation(),!1):void 0}).on("focus.ui.dropdown",function(t){var e=t.target;$(e).is(toggle)&&chkMatch(e,t)}).on("keydown.ui.dropdown",function(t){var e=t.target;$(e).is(toggle)&&Dropdown.prototype.keydown.call(e,t)})});
/*! 
*  frontui v1.0.2
*  by frontpay FE Team
*  (c) 5/17/2016 www.frontpay.cn
*  Licensed under Apache License
*/
"use strict";function Plugin(t,o){if(!$(this).length&&t&&/^#(\w*)/gi.test($(this).selector)){var i,e;"string"==typeof t&&(e=t,t={title:"\u6807\u9898",content:""}),t.mid=$(this).selector.replace(/^#/g,"");var n=Modal.CreateModal(t);n.data("mid",t.mid);var a=$.extend({},Modal.DEFAULTS,"object"==typeof t&&t);return n.data("ui.modal",i=new Modal(n,a)),e&&"function"==typeof i[e]&&i[e](o),t.callback&&t.callback.call(n),i.show(o),$(this)}return $(this).each(function(){var i=$(this),e=i.data("ui.modal"),n=$.extend({},Modal.DEFAULTS,i.data(),"object"==typeof t&&t);e||i.data("ui.modal",e=new Modal(this,n)),"string"==typeof t?e[t](o):n.show&&(n.title&&e.setTitle(n.title),n.content&&e.setContent(n.content),e.show(o))})}var Modal=function(t,o){this.$el=$(t),this.options=o,this.$body=$(document.body),this.$dialog=this.$el.find(".modal-wrap"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.options.remote&&this.$el.find(".modal-body").load(this.options.remote,$.proxy(function(){this.$element.trigger("loaded.ui.modal")},this))};Modal.VERSION="1.0.0",Modal.TRANSITION_DURATION=150,Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},Modal.TEMPLATE=['<div class="modal-background fade" id="{{mid}}">','<div class="modal-layer">','<div class="modal-position">','<div class="modal-wrap">','<div class="modal-head">','<span class="modal-title">{{title}}</span>','<button class="modal-close">',"<i></i>","</button>","</div>",'<div class="modal-body">',"{{content}}","</div>","</div>","</div>","</div>","</div>"].join(""),Modal.CreateModal=function(t){var o,i=$(document.body);return t&&"object"==typeof t&&(o=Modal.TEMPLATE.replace(/{{(\w*)}}/gi,function(o,i){return t[i]&&"string"==typeof t[i]?/^(\.|#)\w*/gi.test(t[i])?$(t[i]).html():t[i]:t[i]&&t[i].length&&t.length>0?t[i].html():void 0}),o=$(o).hide().appendTo(i)),o},Modal.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},Modal.prototype.show=function(t){var o=this,i=$.Event("show.ui.modal",{relatedTarget:t});if(!this.isShown&&!i.isDefaultPrevented()){this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$el.on("click.dismiss.ui.modal",'[data-dismiss="modal"],.modal-close',$.proxy(this.hide,this));var e=$.support.transition&&o.$el.hasClass("fade");o.$el.show().scrollTop(0).attr("tabindex",-1),o.adjustDialog(),e&&o.$el[0].offsetWidth,o.enforceFocus(),e?(o.$el.addClass("in").attr("aria-hidden",!1),o.$dialog.one("uiTransitionEnd",function(){o.$el.trigger("focus").trigger(i)}).emulateTransitionEnd(Modal.TRANSITION_DURATION)):o.$el.hide().addClass("in").attr("aria-hidden",!1).fadeIn(Modal.TRANSITION_DURATION,function(){$(this).trigger("focus").trigger(i)}).attr("aria-hidden",!1)}},Modal.prototype.hide=function(t){t&&t.preventDefault();var o=this;(this.$el.is(":visible")||this.isShown)&&(this.isShown=!1,this.escape(),this.resize(),$(document).off("focusin.ui.modal").off("keydown.ui.modal"),this.$el.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.ui.modal").off("mouseup.dismiss.ui.modal"),this.$dialog.off("mousedown.dismiss.ui.modal"),$.support.transition&&this.$el.hasClass("fade")?this.$el.one("uiTransitionEnd",$.proxy(this.hideModal,this)).emulateTransitionEnd(Modal.TRANSITION_DURATION):function(){o.$el.fadeOut(Modal.TRANSITION_DURATION,function(){o.hideModal()})}())},Modal.prototype.close=function(t){$(t).data("ui.modal").hide()},Modal.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$el.on("keydown.dismiss.ui.modal",$.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$el.off("keydown.dismiss.ui.modal")},Modal.prototype.hideModal=function(){var t=this,o=$.Event("hide.ui.modal",{relatedTarget:t.$el});t.$el.hide(),t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$el.trigger(o)},Modal.prototype.resize=function(){},Modal.prototype.handleUpdate=function(){this.adjustDialog()},Modal.prototype.adjustDialog=function(){return},Modal.prototype.resetAdjustments=function(){this.$el.css({paddingLeft:"",paddingRight:""})},Modal.prototype.enforceFocus=function(){$(document).off("focusin.ui.modal").on("focusin.ui.modal",$.proxy(function(t){this.$el[0]===t.target||this.$el.has(t.target).length||this.$el.trigger("focus")},this))},Modal.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var o=document.documentElement.getBoundingClientRect();t=o.right-Math.abs(o.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},Modal.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},Modal.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},Modal.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var o=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),o},Modal.prototype.setContent=function(t){var o=this.$el.find(".modal-body");o.length&&o.html(t||"")},Modal.prototype.setTitle=function(t){var o=this.$el.find(".modal-title");o.length&&o.html(t||"")},$.fn.modal=Plugin,$.fn.modal.Constructor=Modal,$.fn.showLoading=function(t,o){var t=t||"\u5904\u7406\u4e2d...",o=o||"\u8bf7\u4e0d\u8981\u5173\u95ed\u6d4f\u89c8\u5668\uff0c\u7cfb\u7edf\u6b63\u5728\u5904\u7406";if($(this).length)return t&&$(this).find(".modal-body h3").html(t),o&&$(this).find(".loading-content").html(o),$(this).modal("show");var i=['<div class="notice-wrap waiting in-modal">','<div class="notice-box">','<span class="notice-img"></span>',"<h3>"+t+"</h3>",'<div class="loading-content">'+o+"</div>","</div>","</div>"].join("");return $(this).modal({title:"\u63d0\u793a",content:i,callback:function(){$(this).find(".modal-close").hide()}})},$.fn.hideLoading=function(){return $(this).length&&$(this).modal("hide")},$.showLoading=function(t,o){var i="#ui-loading";return $(i).showLoading(t,o)},$.hideLoading=function(){var t="#ui-loading";return $(t).hideLoading()},$.fn.modalLayer=function(t){var o,i={icon:"success",title:"\u6210\u529f",content:"",close:!0,buttons:[{text:"\u786e\u5b9a",href:!1,style:"btn primary",target:!1,ok:$.noop}]},e=$(this);o=$.extend({},i,t);for(var n=['<div class="notice-wrap '+o.icon+' in-modal" role="icon">','<div class="modalLayer notice-box">','<span class="notice-img"></span>','<h3 role="title" class="modalLayer-title '+(""==$.trim(o.content)?"fn-mt-20":"")+'">'+o.title+"</h3>",'<div class="modalLayer-content" role="content">'+o.content+"</div>","</div>","</div>",'<div class="in-modal-btns text-align-center">',"</div>"],a=[],l=o.buttons,s=0;s<l.length;s++)l[s].href?a.push('<a href="'+l[s].href+'" '+(l[s].target?'target="'+l[s].target+'"':"")+' class="'+(l[s].style||"btn primary")+'" data-index="'+s+'">'+l[s].text+"</a>"):a.push('<button type="button" class="'+(l[s].style||"btn primary")+'" data-index="'+s+'">'+l[s].text+"</button>");n.splice(-1,0,a.join("")),e=$(this).modal({title:"\u63d0\u793a",content:n.join(""),callback:function(t){$(this).on("click",".in-modal-btns .btn",function(){var t=$(this).data("index"),i=!0;o.buttons.length&&o.buttons[t]&&o.buttons[t].ok&&o.buttons[t].ok&&"function"==typeof o.buttons[t].ok&&(i=o.buttons[t].ok.call(null,$(this),t)===!1?!1:!0),$(e.selector).data("options",o),i&&$(e.selector).modal("hide")}).on("hide.ui.modal",function(){$(this).remove()}),console.log(o.close),o.close||$(e.selector).find(".modal-close").hide(),$.isFunction(o.close)&&$(this).on("hide.ui.modal",o.close)}})};var Handler=function(){var t=$(this),o=$(this).attr("href"),i=$(t.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),e=i.data("ui.modal")?"toggle":$.extend({remote:!/#/.test(o)&&o},i.data(),t.data());Plugin.call(i,e,this)},initModal=function(){$(document).on("click.ui.modal",'[data-toggle="modal"]',function(t){var o=t.target;$(o).is('[data-toggle="modal"]')&&Handler.call(o,t)})};$(initModal);var successModalLayer=function(t){return function(o){var i=o.id?o.id:"#j-modal-status";t(i).modalLayer({icon:"success",title:o.title||"",content:o.content||"",buttons:[{text:"\u786e\u8ba4",ok:function(){o&&"string"==typeof o.link&&(location.href=o.link),o&&"function"==typeof o.callback&&o.callback()}}]})}}(jQuery),confirmModalLayer=function(t){return function(o){var i=o.id?o.id:"#confirmModalLayer";t(i).modalLayer({icon:"info",title:o.title||"",content:o.content||"",buttons:[{text:"\u786e\u5b9a",ok:o.callback},{text:"\u53d6\u6d88",href:"javascript:void(0);",style:"btn links fn-ml-10"}]})}}(jQuery),alertModalLayer=function(t){return function(o){var i=o.id?o.id:"#alertModalLayer";t(i).modalLayer({icon:o.icon||"info",title:o.title||"",content:o.content||""})}}(jQuery),closeModalLayer=function(t){return function(o,i){t(o).modal("hide").on("hide.ui.modal",function(){t(this).remove(),"function"==typeof i&&i()})}}(jQuery);$.successModalLayer=successModalLayer,$.confirmModalLayer=confirmModalLayer,$.alertModalLayer=alertModalLayer,$.closeModalLayer=closeModalLayer,~function(t){function o(t,o,i){this.selector=t,this.next=i,this.opt=o,this.dialog=this.get(t),this.showModal(o)}o.prototype.showModal=function(o){var i=this;o.show=!1,o.content="",o.callback=function(){i.dialog=t(i.selector),i.$dom=t(this),o&&o.url&&(i.originalUrl=o.url,i.init(),"function"==typeof i.next&&i.next.call(i,i.$dom))},i.dialog.modal(o)},o.prototype.init=function(o){var i=this.$dom.find(".modal-body");this.$title=this.$dom.find(".modal-title"),this.$iframe=t("<iframe />"),this.$iframe.attr({src:o||this.originalUrl,width:this.opt.width||"100%",height:this.opt.height||"100%",allowtransparency:"yes",frameborder:"no",scrolling:"no"}).on("load",t.proxy(this.adjustHeight,this)),i.empty().append(this.$iframe)},o.prototype.setProp=function(t){t.title&&this.$title.html(t.title),t.url&&(this.$iframe[0].src=t.url)},o.prototype.setUrl=function(t){return this.init(t),!0},o.prototype.adjustHeight=function(){var t,o;try{t=this.$iframe[0].contentWindow.frameElement}catch(i){}t&&(o=this.$iframe.contents().height(),this.$iframe.css({height:o+"px"}))},o.prototype.show=function(){this.dialog.modal("show")},o.prototype.hide=function(){this.dialog.modal("hide")},o.get=o.prototype.get=function(o){if(o&&o.frameElement){var i,e=o.frameElement,n=t(".modal-background",o.parent.document);return n.each(function(o,n){var a=t(n).find("iframe");a[0]===e&&(i=t(n))}),i}return t(o)},o.close=function(i){var e=o.get(i);t(e).find(".modal-close").trigger("click"),t(e).remove()},o.adjustHeight=function(i){var e,n,a=o.get(i),l=t(a).find("iframe");try{e=l[0].contentWindow.frameElement}catch(s){}e&&(n=l.contents().height(),l.css({height:n+"px"}))},t.fn.iframeModal=function(i,e){var n=t(this),a=t(this).selector;if((this[0]===window||this[0]===parent)&&"hide"==i)return void o.close(window);if(this[0]===window&&"adjustHeight"==i)return void o.adjustHeight(window);var l=n.data("ui.iframeModal");l?i&&i.url&&i.reset?l&&l.setUrl(i.url)&&l.show():(t.isPlainObject(i)&&l.setProp(i),l&&l.show()):l=new o(a,i,function(o){t(o).data("ui.iframeModal",this)}),"string"==typeof i&&l[i]&&l[i](e)},t(function(){t(document).on("click",'[data-toggle="iframeModal"]',function(o){o.preventDefault();var i=t(this).attr("data-title")||"\u63d0\u793a",e=t(this).attr("data-url");e&&i&&t("#iframe-modal").iframeModal({title:i,url:e})})})}(jQuery);
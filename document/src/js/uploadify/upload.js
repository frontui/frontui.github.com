!function(t,e){var i=function(t,n){return this.$el=e(t),this.$parent=this.$el.parent(),this.option=e.extend({},i.DEFAULTS,n),this.$input=e(this.option.inputText),this.$queue=null,this.$input.length||this.option.itemTemplate?(this.init(),this):void alert("FileUpload:配置参数input尚未配置")};i.errMsg={"-100":"超出上传限制个数","-110":"超出了文件大小","-120":"文件为空","-130":"文件格式有误","-200":"网络断开","-210":"上传地址有误","-220":"文件读写错误","-230":"权限不足","-240":"上传限制超过","-250":"上传失败","-260":"未找到指定文件","-270":"文件验证失败","-280":"文件被取消","-290":"上传中断"},i.DEFAULTS={auto:!0,beforeUpload:function(){return!0},inputText:"#j-uploadfile",fileName:"",buttonText:"选择图片",multi:!1,removeCompleted:!1,fileSizeLimit:"200KB",swf:"javascript/uploadify/uploadify.swf",uploader:"javascript/uploadify/uploadify.php",fileTypeExts:"*.jpg;*.png",fileTypeDesc:"请选择 jpg png 文件",overrideEvents:["onUploadError","onSelectError","onUploadStart","onSelect"],queueID:"j-uploadfile-queue",onDialogClose:function(t,e,i){},onSelectError:function(t,n,o){var o=i.errMsg[n],u=[-280];switch(n){case-110:o+="(200Kb)";break;case-130:o+="(请选择jpg,png类型文件)"}e.inArray(u,n)||alert(o+",错误代码："+n)},onUploadError:function(t,n,o,u){var o=i.errMsg[n],a=[-280];switch(n){case-110:o+="(200Kb)";break;case-130:o+="(请选择jpg,png类型文件)"}e.inArray(a,n)||alert(o+",错误代码："+n+","+u)}},i.prototype={init:function(){var t=this;this.option.onSelect=function(e){t.queueId=e.id,e.name&&t.queueComplete(),t.option.auto||t.upload()},this.option.onUploadProgress=function(e,i,n,o,u){t.uploadProgress(e,i,n,o,u)},this.option.onUploadSuccess=function(){t.success.call(t,arguments)},this.option.onQueueComplete=function(){t.clear()},this.$el.uploadify(this.option),this.$queue=e('<div id="'+this.$el[0].id+'-queue" class="uploadify-queue"><div class="uploadify-queue-bg"></div><b>0%</b></div>').appendTo(document.body),this.render()},run:function(t){var e=[].slice.apply(arguments,1);t&&this.$el.uploadify(t,e)},render:function(){if(!this.option.itemTemplate){var t=this.$input.offset(),e=this.$input.outerWidth(),i=this.$input.outerHeight();this.$queue.length>0&&this.$queue.css({top:t.top,left:t.left,width:e,height:i,"line-height":i+"px"})}},queueComplete:function(){this.$queue.show()},upload:function(){this.option.beforeUpload()?this.$el.uploadify("upload","*"):this.clear()},uploadProgress:function(t,e,i,n,o){var u=Math.floor(100*e/i);this.$queue.find("b").html(u+"%"),this.$queue.find("div").css("width",u+"%")},success:function(t,e,i){var n=this;this.$queue.fadeOut(1e3),this.$input.val(t[0].name),this.$parent.find(".ticon-attach").length>0?this.$parent.find(".ticon-attach").html('<img src="'+t[1]+'" alt=""><b>'+t[0].name+"</b>"):this.$parent.prepend('<span class="ticon-attach"><img src="'+t[1]+'" alt=""><b>'+t[0].name+"</b></span>"),setTimeout(function(){n.clear()},2e3)},clear:function(){var t=this;this.$queue.fadeOut(300,function(){t.$queue.find("b").html("0%"),t.$queue.find("div").css("width","0%")}),this.$el.uploadify("cancel","*")}};var n=function(t){return e(this).each(function(){var n=e(this),o=n.data("uploadFile");o||n.data("uploadFile",o=new i(n,t)),"string"==typeof t&&o[t]&&o[t]()})};e.fn.fileUpload=n,e.fn.fileUpload.constructor=i,t.FileUpload=i}(window,jQuery);